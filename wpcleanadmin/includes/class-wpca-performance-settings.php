<?php\r\n/**\r\n * WPCleanAdmin Performance Settings Class\r\n *\r\n * @package WPCleanAdmin\r\n * @version 1.7.15\r\n * @author Sut\r\n * @author URI: https://github.com/sutchan\r\n * @since 1.7.15\r\n */\r\nnamespace WPCleanAdmin;\r\n\r\n/**\r\n * Performance Settings class for WP Clean Admin plugin\r\n *\r\n * @package WPCleanAdmin\r\n */\r\n\r\nif ( ! defined( 'ABSPATH' ) ) {\r\n    exit;\r\n}\r\n\r\n/**\r\n * Performance_Settings class\r\n */\r\nclass Performance_Settings {\r\n    \r\n    /**\r\n     * Singleton instance\r\n     *\r\n     * @var Performance_Settings\r\n     */\r\n    private static $instance;\r\n    \r\n    /**\r\n     * Get singleton instance\r\n     *\r\n     * @return Performance_Settings\r\n     */\r\n    public static function getInstance() {\r\n        if ( ! isset( self::$instance ) ) {\r\n            self::$instance = new self();\r\n        }\r\n        return self::$instance;\r\n    }\r\n    \r\n    /**\r\n     * Constructor\r\n     */\r\n    private function __construct() {\r\n        $this->init();\r\n    }\r\n    \r\n    /**\r\n     * Initialize the performance settings module\r\n     */\r\n    public function init() {\r\n        // Register settings\r\n        \add_action( 'admin_init', array( $this, 'register_settings' ) );\r\n    }\r\n    \r\n    /**\r\n     * Register performance settings\r\n     */\r\n    public function register_settings() {\r\n        // Register performance settings section\r\n        \add_settings_section(\r\n            'wpca_performance_settings',\r\n            \__( 'Performance Settings', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'settings_section_callback' ),\r\n            'wpca_settings'\r\n        );\r\n        \r\n        // Register disable emojis setting\r\n        \add_settings_field(\r\n            'wpca_disable_emojis',\r\n            \__( 'Disable Emojis', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'disable_emojis_field_callback' ),\r\n            'wpca_settings',\r\n            'wpca_performance_settings'\r\n        );\r\n        \r\n        // Register disable embeds setting\r\n        \add_settings_field(\r\n            'wpca_disable_embeds',\r\n            \__( 'Disable Embeds', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'disable_embeds_field_callback' ),\r\n            'wpca_settings',\r\n            'wpca_performance_settings'\r\n        );\r\n        \r\n        // Register disable XML-RPC setting\r\n        \add_settings_field(\r\n            'wpca_disable_xmlrpc',\r\n            \__( 'Disable XML-RPC', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'disable_xmlrpc_field_callback' ),\r\n            'wpca_settings',\r\n            'wpca_performance_settings'\r\n        );\r\n        \r\n        // Register disable REST API setting\r\n        \add_settings_field(\r\n            'wpca_disable_rest_api',\r\n            \__( 'Disable REST API', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'disable_rest_api_field_callback' ),\r\n            'wpca_settings',\r\n            'wpca_performance_settings'\r\n        );\r\n        \r\n        // Register disable jQuery migrate setting\r\n        \add_settings_field(\r\n            'wpca_disable_jquery_migrate',\r\n            \__( 'Disable jQuery Migrate', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'disable_jquery_migrate_field_callback' ),\r\n            'wpca_settings',\r\n            'wpca_performance_settings'\r\n        );\r\n        \r\n        // Register lazy load images setting\r\n        \add_settings_field(\r\n            'wpca_lazy_load_images',\r\n            \__( 'Lazy Load Images', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'lazy_load_images_field_callback' ),\r\n            'wpca_settings',\r\n            'wpca_performance_settings'\r\n        );\r\n        \r\n        // Register settings\r\n        \register_setting( 'wpca_settings', 'wpca_performance_settings' );\r\n    }\r\n    \r\n    /**\r\n     * Settings section callback\r\n     */\r\n    public function settings_section_callback() {\r\n        echo '<p>' . \__( 'Configure performance optimization settings to improve your website speed.', WPCA_TEXT_DOMAIN ) . '</p>';\r\n    }\r\n    \r\n    /**\r\n     * Disable emojis field callback\r\n     */\r\n    public function disable_emojis_field_callback() {\r\n        $settings = $this->get_settings();\r\n        $checked = isset( $settings['disable_emojis'] ) && $settings['disable_emojis'] ? 'checked' : '';\r\n        echo '<input type="checkbox" name="wpca_performance_settings[disable_emojis]" id="wpca_disable_emojis" value="1" ' . $checked . '>';\r\n        echo '<label for="wpca_disable_emojis">' . \__( 'Disable WordPress emojis', WPCA_TEXT_DOMAIN ) . '</label>';\r\n    }\r\n    \r\n    /**\r\n     * Disable embeds field callback\r\n     */\r\n    public function disable_embeds_field_callback() {\r\n        $settings = $this->get_settings();\r\n        $checked = isset( $settings['disable_embeds'] ) && $settings['disable_embeds'] ? 'checked' : '';\r\n        echo '<input type="checkbox" name="wpca_performance_settings[disable_embeds]" id="wpca_disable_embeds" value="1" ' . $checked . '>';\r\n        echo '<label for="wpca_disable_embeds">' . \__( 'Disable WordPress embeds', WPCA_TEXT_DOMAIN ) . '</label>';\r\n    }\r\n    \r\n    /**\r\n     * Disable XML-RPC field callback\r\n     */\r\n    public function disable_xmlrpc_field_callback() {\r\n        $settings = $this->get_settings();\r\n        $checked = isset( $settings['disable_xmlrpc'] ) && $settings['disable_xmlrpc'] ? 'checked' : '';\r\n        echo '<input type="checkbox" name="wpca_performance_settings[disable_xmlrpc]" id="wpca_disable_xmlrpc" value="1" ' . $checked . '>';\r\n        echo '<label for="wpca_disable_xmlrpc">' . \__( 'Disable XML-RPC', WPCA_TEXT_DOMAIN ) . '</label>';\r\n    }\r\n    \r\n    /**\r\n     * Disable REST API field callback\r\n     */\r\n    public function disable_rest_api_field_callback() {\r\n        $settings = $this->get_settings();\r\n        $checked = isset( $settings['disable_rest_api'] ) && $settings['disable_rest_api'] ? 'checked' : '';\r\n        echo '<input type="checkbox" name="wpca_performance_settings[disable_rest_api]" id="wpca_disable_rest_api" value="1" ' . $checked . '>';\r\n        echo '<label for="wpca_disable_rest_api">' . \__( 'Disable REST API', WPCA_TEXT_DOMAIN ) . '</label>';\r\n    }\r\n    \r\n    /**\r\n     * Disable jQuery migrate field callback\r\n     */\r\n    public function disable_jquery_migrate_field_callback() {\r\n        $settings = $this->get_settings();\r\n        $checked = isset( $settings['disable_jquery_migrate'] ) && $settings['disable_jquery_migrate'] ? 'checked' : '';\r\n        echo '<input type="checkbox" name="wpca_performance_settings[disable_jquery_migrate]" id="wpca_disable_jquery_migrate" value="1" ' . $checked . '>';\r\n        echo '<label for="wpca_disable_jquery_migrate">' . \__( 'Disable jQuery Migrate', WPCA_TEXT_DOMAIN ) . '</label>';\r\n    }\r\n    \r\n    /**\r\n     * Lazy load images field callback\r\n     */\r\n    public function lazy_load_images_field_callback() {\r\n        $settings = $this->get_settings();\r\n        $checked = isset( $settings['lazy_load_images'] ) && $settings['lazy_load_images'] ? 'checked' : '';\r\n        echo '<input type="checkbox" name="wpca_performance_settings[lazy_load_images]" id="wpca_lazy_load_images" value="1" ' . $checked . '>';\r\n        echo '<label for="wpca_lazy_load_images">' . \__( 'Enable lazy loading for images', WPCA_TEXT_DOMAIN ) . '</label>';\r\n    }\r\n    \r\n    /**\r\n     * Get performance settings\r\n     *\r\n     * @return array Performance settings\r\n     */\r\n    public function get_settings() {\r\n        $settings = \get_option( 'wpca_performance_settings', array() );\r\n        \r\n        $default_settings = array(\r\n            'disable_emojis' => 1,\r\n            'disable_embeds' => 0,\r\n            'disable_xmlrpc' => 0,\r\n            'disable_rest_api' => 0,\r\n            'disable_jquery_migrate' => 1,\r\n            'lazy_load_images' => 1\r\n        );\r\n        \r\n        return function_exists( '\wp_parse_args' ) ? \wp_parse_args( $settings, $default_settings ) : array_merge( $default_settings, $settings );\r\n    }\r\n    \r\n    /**\r\n     * Save performance settings\r\n     *\r\n     * @param array $settings Settings to save\r\n     * @return bool Save result\r\n     */\r\n    public function save_settings( $settings ) {\r\n        return \update_option( 'wpca_performance_settings', $settings );\r\n    }\r\n    \r\n    /**\r\n     * Reset performance settings\r\n     *\r\n     * @return bool Reset result\r\n     */\r\n    public function reset_settings() {\r\n        return \delete_option( 'wpca_performance_settings' );\r\n    }\r\n}