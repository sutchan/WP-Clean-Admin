<?php\r\n/**\r\n * WPCleanAdmin Core Class\r\n *\r\n * @package WPCleanAdmin\r\n * @version 1.7.15\r\n * @author Sut\r\n * @author URI: https://github.com/sutchan\r\n * @since 1.7.15\r\n */\r\nnamespace WPCleanAdmin;\r\n\r\n/**\r\n * Core class for WP Clean Admin plugin\r\n *\r\n * @package WPCleanAdmin\r\n */\r\n\r\nif ( ! defined( 'ABSPATH' ) ) {\r\n    exit;\r\n}\r\n\r\n/**\r\n * Core class\r\n */\r\nclass Core {\r\n    \r\n    /**\r\n     * Singleton instance\r\n     *\r\n     * @var Core\r\n     */\r\n    private static $instance;\r\n    \r\n    /**\r\n     * Get singleton instance\r\n     *\r\n     * @return Core\r\n     */\r\n    public static function getInstance() {\r\n        if ( ! isset( self::$instance ) ) {\r\n            self::$instance = new self();\r\n        }\r\n        return self::$instance;\r\n    }\r\n    \r\n    /**\r\n     * Constructor\r\n     */\r\n    private function __construct() {\r\n        $this->init();\r\n    }\r\n    \r\n    /**\r\n     * Initialize the plugin\r\n     */\r\n    public function init() {\r\n        // Load core functions\r\n        require_once WPCA_PLUGIN_DIR . 'includes/wpca-core-functions.php';\r\n        \r\n        // Initialize modules\r\n        $this->init_modules();\r\n    }\r\n    \r\n    /**\r\n     * Initialize all plugin modules\r\n     */\r\n    private function init_modules() {\r\n        // Load settings module\r\n        Settings::getInstance();\r\n        \r\n        // Load dashboard module\r\n        Dashboard::getInstance();\r\n        \r\n        // Load database module\r\n        Database::getInstance();\r\n        \r\n        // Load performance module\r\n        Performance::getInstance();\r\n        \r\n        // Load menu manager module\r\n        Menu_Manager::getInstance();\r\n        \r\n        // Load menu customizer module\r\n        Menu_Customizer::getInstance();\r\n        \r\n        // Load permissions module\r\n        Permissions::getInstance();\r\n        \r\n        // Load user roles module\r\n        User_Roles::getInstance();\r\n        \r\n        // Load login module\r\n        Login::getInstance();\r\n        \r\n        // Load cleanup module\r\n        Cleanup::getInstance();\r\n        \r\n        // Load resources module\r\n        Resources::getInstance();\r\n        \r\n        // Load reset module\r\n        Reset::getInstance();\r\n        \r\n        // Load AJAX module\r\n        AJAX::getInstance();\r\n        \r\n        // Load i18n module\r\n        i18n::getInstance();\r\n    }\r\n    \r\n    /**\r\n     * Plugin activation callback\r\n     */\r\n    public function activate() {\r\n        // Set default settings\r\n        $this->set_default_settings();\r\n        \r\n        // Flush rewrite rules\r\n        \flush_rewrite_rules();\r\n    }\r\n    \r\n    /**\r\n     * Plugin deactivation callback\r\n     */\r\n    public function deactivate() {\r\n        // Flush rewrite rules\r\n        flush_rewrite_rules();\r\n    }\r\n    \r\n    /**\r\n     * Set default plugin settings\r\n     */\r\n    private function set_default_settings() {\r\n        $default_settings = array(\r\n            'general' => array(\r\n                'clean_admin_bar' => 1,\r\n                'clean_dashboard' => 1,\r\n                'remove_wp_logo' => 1,\r\n            ),\r\n            'performance' => array(\r\n                'optimize_database' => 1,\r\n                'clean_transients' => 1,\r\n                'disable_emojis' => 1,\r\n            ),\r\n            'menu' => array(\r\n                'remove_dashboard_widgets' => 1,\r\n                'simplify_admin_menu' => 1,\r\n            ),\r\n        );\r\n        \r\n        // Update settings if they don't exist\r\n        $current_settings = ( function_exists( 'get_option' ) ? \get_option( 'wpca_settings', array() ) : array() );\r\n        $updated_settings = ( function_exists( 'wp_parse_args' ) ? \wp_parse_args( $current_settings, $default_settings ) : array_merge( $default_settings, $current_settings ) );\r\n        \r\n        if ( function_exists( 'update_option' ) ) {\r\n            \update_option( 'wpca_settings', $updated_settings );\r\n        }\r\n    }\r\n}\r\n