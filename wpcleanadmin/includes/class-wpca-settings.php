<?php\r\n/**\r\n * WPCleanAdmin Settings Class\r\n *\r\n * @package WPCleanAdmin\r\n * @version 1.7.15\r\n * @author Sut\r\n * @author URI: https://github.com/sutchan\r\n * @since 1.7.15\r\n */\r\nnamespace WPCleanAdmin;\r\n\r\n/**\r\n * Settings class for WP Clean Admin plugin\r\n *\r\n * @package WPCleanAdmin\r\n */\r\n\r\nif ( ! defined( 'ABSPATH' ) ) {\r\n    exit;\r\n}\r\n\r\n/**\r\n * Settings class\r\n */\r\nclass Settings {\r\n    \r\n    /**\r\n     * Singleton instance\r\n     *\r\n     * @var Settings\r\n     */\r\n    private static $instance;\r\n    \r\n    /**\r\n     * Get singleton instance\r\n     *\r\n     * @return Settings\r\n     */\r\n    public static function getInstance() {\r\n        if ( ! isset( self::$instance ) ) {\r\n            self::$instance = new self();\r\n        }\r\n        return self::$instance;\r\n    }\r\n    \r\n    /**\r\n     * Constructor\r\n     */\r\n    private function __construct() {\r\n        $this->init();\r\n    }\r\n    \r\n    /**\r\n     * Initialize settings module\r\n     */\r\n    public function init() {\r\n        // Register settings page\r\n        \add_action( 'admin_menu', array( $this, 'register_settings_page' ) );\r\n        \r\n        // Register settings\r\n        \add_action( 'admin_init', array( $this, 'register_settings' ) );\r\n        \r\n        // Enqueue admin scripts and styles\r\n        \add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_scripts' ) );\r\n    }\r\n    \r\n    /**\r\n     * Register settings page\r\n     */\r\n    public function register_settings_page() {\r\n        // Add main settings page\r\n        \add_menu_page(\r\n            \__( 'WP Clean Admin', WPCA_TEXT_DOMAIN ),\r\n            \__( 'Clean Admin', WPCA_TEXT_DOMAIN ),\r\n            'manage_options',\r\n            'wp-clean-admin',\r\n            array( $this, 'render_settings_page' ),\r\n            'dashicons-admin-generic',\r\n            60\r\n        );\r\n        \r\n        // Add submenu pages\r\n        \add_submenu_page(\r\n            'wp-clean-admin',\r\n            \__( 'Settings', WPCA_TEXT_DOMAIN ),\r\n            \__( 'Settings', WPCA_TEXT_DOMAIN ),\r\n            'manage_options',\r\n            'wp-clean-admin',\r\n            array( $this, 'render_settings_page' )\r\n        );\r\n    }\r\n    \r\n    /**\r\n     * Register plugin settings\r\n     */\r\n    public function register_settings() {\r\n        // Register general settings section\r\n        \add_settings_section(\r\n            'wpca_general_settings',\r\n            \__( 'General Settings', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'render_general_settings_section' ),\r\n            'wp-clean-admin'\r\n        );\r\n        \r\n        // Register general settings fields\r\n        \add_settings_field(\r\n            'wpca_clean_admin_bar',\r\n            \__( 'Clean Admin Bar', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'render_clean_admin_bar_field' ),\r\n            'wp-clean-admin',\r\n            'wpca_general_settings'\r\n        );\r\n        \r\n        \add_settings_field(\r\n            'wpca_remove_wp_logo',\r\n            \__( 'Remove WordPress Logo', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'render_remove_wp_logo_field' ),\r\n            'wp-clean-admin',\r\n            'wpca_general_settings'\r\n        );\r\n        \r\n        // Register cleanup settings section\r\n        \add_settings_section(\r\n            'wpca_cleanup_settings',\r\n            \__( 'Cleanup Settings', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'render_cleanup_settings_section' ),\r\n            'wp-clean-admin'\r\n        );\r\n        \r\n        // Register cleanup settings fields\r\n        \add_settings_field(\r\n            'wpca_remove_dashboard_widgets',\r\n            \__( 'Remove Dashboard Widgets', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'render_remove_dashboard_widgets_field' ),\r\n            'wp-clean-admin',\r\n            'wpca_cleanup_settings'\r\n        );\r\n        \r\n        \add_settings_field(\r\n            'wpca_simplify_admin_menu',\r\n            \__( 'Simplify Admin Menu', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'render_simplify_admin_menu_field' ),\r\n            'wp-clean-admin',\r\n            'wpca_cleanup_settings'\r\n        );\r\n        \r\n        // Register performance settings section\r\n        \add_settings_section(\r\n            'wpca_performance_settings',\r\n            \__( 'Performance Settings', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'render_performance_settings_section' ),\r\n            'wp-clean-admin'\r\n        );\r\n        \r\n        // Register performance settings fields\r\n        \add_settings_field(\r\n            'wpca_optimize_database',\r\n            \__( 'Optimize Database', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'render_optimize_database_field' ),\r\n            'wp-clean-admin',\r\n            'wpca_performance_settings'\r\n        );\r\n        \r\n        \add_settings_field(\r\n            'wpca_clean_transients',\r\n            \__( 'Clean Transients', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'render_clean_transients_field' ),\r\n            'wp-clean-admin',\r\n            'wpca_performance_settings'\r\n        );\r\n        \r\n        \add_settings_field(\r\n            'wpca_disable_emojis',\r\n            \__( 'Disable Emojis', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'render_disable_emojis_field' ),\r\n            'wp-clean-admin',\r\n            'wpca_performance_settings'\r\n        );\r\n        \r\n        // Register security settings section\r\n        \add_settings_section(\r\n            'wpca_security_settings',\r\n            \__( 'Security Settings', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'render_security_settings_section' ),\r\n            'wp-clean-admin'\r\n        );\r\n        \r\n        // Register security settings fields\r\n        \add_settings_field(\r\n            'wpca_hide_wp_version',\r\n            \__( 'Hide WordPress Version', WPCA_TEXT_DOMAIN ),\r\n            array( $this, 'render_hide_wp_version_field' ),\r\n            'wp-clean-admin',\r\n            'wpca_security_settings'\r\n        );\r\n        \r\n        // Register settings\r\n        \register_setting( 'wp-clean-admin', 'wpca_settings', array( $this, 'validate_settings' ) );\r\n    }\r\n    \r\n    /**\r\n     * Render general settings section\r\n     */\r\n    public function render_general_settings_section() {\r\n        echo '<p>' . \__( 'Configure general settings for WP Clean Admin plugin.', WPCA_TEXT_DOMAIN ) . '</p>';\r\n    }\r\n    \r\n    /**\r\n     * Render clean admin bar field\r\n     */\r\n    public function render_clean_admin_bar_field() {\r\n        $settings = \get_option( 'wpca_settings', array() );\r\n        $clean_admin_bar = isset( $settings['general']['clean_admin_bar'] ) ? $settings['general']['clean_admin_bar'] : 1;\r\n        \r\n        echo '<input type="checkbox" name="wpca_settings[general][clean_admin_bar]" value="1" ' . \checked( $clean_admin_bar, 1, false ) . ' />';\r\n        echo '<label for="wpca_clean_admin_bar"> ' . \__( 'Remove unnecessary items from the admin bar.', WPCA_TEXT_DOMAIN ) . '</label>';\r\n    }\r\n    \r\n    /**\r\n     * Render remove WordPress logo field\r\n     */\r\n    public function render_remove_wp_logo_field() {\r\n        $settings = \get_option( 'wpca_settings', array() );\r\n        $remove_wp_logo = isset( $settings['general']['remove_wp_logo'] ) ? $settings['general']['remove_wp_logo'] : 1;\r\n        \r\n        echo '<input type="checkbox" name="wpca_settings[general][remove_wp_logo]" value="1" ' . \checked( $remove_wp_logo, 1, false ) . ' />';\r\n        echo '<label for="wpca_remove_wp_logo"> ' . \__( 'Remove WordPress logo from admin bar.', WPCA_TEXT_DOMAIN ) . '</label>';\r\n    }\r\n    \r\n    /**\r\n     * Render cleanup settings section\r\n     */\r\n    public function render_cleanup_settings_section() {\r\n        echo '<p>' . \__( 'Configure cleanup settings for WP Clean Admin plugin.', WPCA_TEXT_DOMAIN ) . '</p>';\r\n    }\r\n    \r\n    /**\r\n     * Render remove dashboard widgets field\r\n     */\r\n    public function render_remove_dashboard_widgets_field() {\r\n        $settings = \get_option( 'wpca_settings', array() );\r\n        $remove_dashboard_widgets = isset( $settings['menu']['remove_dashboard_widgets'] ) ? $settings['menu']['remove_dashboard_widgets'] : 1;\r\n        \r\n        echo '<input type="checkbox" name="wpca_settings[menu][remove_dashboard_widgets]" value="1" ' . \checked( $remove_dashboard_widgets, 1, false ) . ' />';\r\n        echo '<label for="wpca_remove_dashboard_widgets"> ' . \__( 'Remove unnecessary dashboard widgets.', WPCA_TEXT_DOMAIN ) . '</label>';\r\n    }\r\n    \r\n    /**\r\n     * Render simplify admin menu field\r\n     */\r\n    public function render_simplify_admin_menu_field() {\r\n        $settings = \get_option( 'wpca_settings', array() );\r\n        $simplify_admin_menu = isset( $settings['menu']['simplify_admin_menu'] ) ? $settings['menu']['simplify_admin_menu'] : 1;\r\n        \r\n        echo '<input type="checkbox" name="wpca_settings[menu][simplify_admin_menu]" value="1" ' . \checked( $simplify_admin_menu, 1, false ) . ' />';\r\n        echo '<label for="wpca_simplify_admin_menu"> ' . \__( 'Simplify admin menu by removing unnecessary items.', WPCA_TEXT_DOMAIN ) . '</label>';\r\n    }\r\n    \r\n    /**\r\n     * Render performance settings section\r\n     */\r\n    public function render_performance_settings_section() {\r\n        echo '<p>' . \__( 'Configure performance optimization settings for WP Clean Admin plugin.', WPCA_TEXT_DOMAIN ) . '</p>';\r\n    }\r\n    \r\n    /**\r\n     * Render optimize database field\r\n     */\r\n    public function render_optimize_database_field() {\r\n        $settings = \get_option( 'wpca_settings', array() );\r\n        $optimize_database = isset( $settings['performance']['optimize_database'] ) ? $settings['performance']['optimize_database'] : 1;\r\n        \r\n        echo '<input type="checkbox" name="wpca_settings[performance][optimize_database]" value="1" ' . \checked( $optimize_database, 1, false ) . ' />';\r\n        echo '<label for="wpca_optimize_database"> ' . \__( 'Automatically optimize database tables.', WPCA_TEXT_DOMAIN ) . '</label>';\r\n    }\r\n    \r\n    /**\r\n     * Render clean transients field\r\n     */\r\n    public function render_clean_transients_field() {\r\n        $settings = \get_option( 'wpca_settings', array() );\r\n        $clean_transients = isset( $settings['performance']['clean_transients'] ) ? $settings['performance']['clean_transients'] : 1;\r\n        \r\n        echo '<input type="checkbox" name="wpca_settings[performance][clean_transients]" value="1" ' . \checked( $clean_transients, 1, false ) . ' />';\r\n        echo '<label for="wpca_clean_transients"> ' . \__( 'Automatically clean expired transients.', WPCA_TEXT_DOMAIN ) . '</label>';\r\n    }\r\n    \r\n    /**\r\n     * Render disable emojis field\r\n     */\r\n    public function render_disable_emojis_field() {\r\n        $settings = \get_option( 'wpca_settings', array() );\r\n        $disable_emojis = isset( $settings['performance']['disable_emoji'] ) ? $settings['performance']['disable_emoji'] : 1;\r\n        \r\n        echo '<input type="checkbox" name="wpca_settings[performance][disable_emoji]" value="1" ' . \checked( $disable_emojis, 1, false ) . ' />';\r\n        echo '<label for="wpca_disable_emojis"> ' . \__( 'Disable WordPress emoji support.', WPCA_TEXT_DOMAIN ) . '</label>';\r\n    }\r\n    \r\n    /**\r\n     * Render security settings section\r\n     */\r\n    public function render_security_settings_section() {\r\n        echo '<p>' . \__( 'Configure security settings for WP Clean Admin plugin.', WPCA_TEXT_DOMAIN ) . '</p>';\r\n    }\r\n    \r\n    /**\r\n     * Render hide WordPress version field\r\n     */\r\n    public function render_hide_wp_version_field() {\r\n        $settings = \get_option( 'wpca_settings', array() );\r\n        $hide_wp_version = isset( $settings['security']['hide_wp_version'] ) ? $settings['security']['hide_wp_version'] : 1;\r\n        \r\n        echo '<input type="checkbox" name="wpca_settings[security][hide_wp_version]" value="1" ' . \checked( $hide_wp_version, 1, false ) . ' />';\r\n        echo '<label for="wpca_hide_wp_version"> ' . \__( 'Hide WordPress version information.', WPCA_TEXT_DOMAIN ) . '</label>';\r\n    }\r\n    \r\n    /**\r\n     * Render settings page\r\n     */\r\n    public function render_settings_page() {\r\n        ?>\r\n        <div class="wrap">\r\n            <h1><?php echo \esc_html( \get_admin_page_title() ); ?></h1>\r\n            <form method="post" action="options.php">\r\n                <?php\r\n                // Output settings fields\r\n                \settings_fields( 'wp-clean-admin' );\r\n                \do_settings_sections( 'wp-clean-admin' );\r\n                \submit_button();\r\n                ?>\r\n            </form>\r\n        </div>\r\n        <?php\r\n    }\r\n    \r\n    /**\r\n     * Validate settings\r\n     *\r\n     * @param array $input Input settings\r\n     * @return array Validated settings\r\n     */\r\n    public function validate_settings( $input ) {\r\n        $validated = array();\r\n        \r\n        // Validate general settings\r\n        if ( isset( $input['general'] ) ) {\r\n            $validated['general'] = array();\r\n            \r\n            // Validate clean admin bar setting\r\n            $validated['general']['clean_admin_bar'] = isset( $input['general']['clean_admin_bar'] ) ? 1 : 0;\r\n            \r\n            // Validate remove WordPress logo setting\r\n            $validated['general']['remove_wp_logo'] = isset( $input['general']['remove_wp_logo'] ) ? 1 : 0;\r\n        }\r\n        \r\n        // Validate menu settings\r\n        if ( isset( $input['menu'] ) ) {\r\n            $validated['menu'] = array();\r\n            \r\n            // Validate remove dashboard widgets setting\r\n            $validated['menu']['remove_dashboard_widgets'] = isset( $input['menu']['remove_dashboard_widgets'] ) ? 1 : 0;\r\n            \r\n            // Validate simplify admin menu setting\r\n            $validated['menu']['simplify_admin_menu'] = isset( $input['menu']['simplify_admin_menu'] ) ? 1 : 0;\r\n        }\r\n        \r\n        // Validate performance settings\r\n        if ( isset( $input['performance'] ) ) {\r\n            $validated['performance'] = array();\r\n            \r\n            // Validate optimize database setting\r\n            $validated['performance']['optimize_database'] = isset( $input['performance']['optimize_database'] ) ? 1 : 0;\r\n            \r\n            // Validate clean transients setting\r\n            $validated['performance']['clean_transients'] = isset( $input['performance']['clean_transients'] ) ? 1 : 0;\r\n            \r\n            // Validate disable emoji setting\r\n            $validated['performance']['disable_emoji'] = isset( $input['performance']['disable_emoji'] ) ? 1 : 0;\r\n        }\r\n        \r\n        // Validate security settings\r\n        if ( isset( $input['security'] ) ) {\r\n            $validated['security'] = array();\r\n            \r\n            // Validate hide WordPress version setting\r\n            $validated['security']['hide_wp_version'] = isset( $input['security']['hide_wp_version'] ) ? 1 : 0;\r\n        }\r\n        \r\n        return $validated;\r\n    }\r\n    \r\n    /**\r\n     * Enqueue admin scripts and styles\r\n     *\r\n     * @param string $hook Current admin page hook\r\n     */\r\n    public function enqueue_scripts( $hook ) {\r\n        // Only enqueue on plugin pages\r\n        if ( \strpos( $hook, 'wp-clean-admin' ) === false ) {\r\n            return;\r\n        }\r\n        \r\n        // Enqueue main CSS\r\n        \wp_enqueue_style(\r\n            'wpca-admin',\r\n            WPCA_PLUGIN_URL . 'assets/css/wpca-admin.css',\r\n            array(),\r\n            WPCA_VERSION\r\n        );\r\n        \r\n        // Enqueue settings CSS\r\n        \wp_enqueue_style(\r\n            'wpca-settings',\r\n            WPCA_PLUGIN_URL . 'assets/css/wpca-settings.css',\r\n            array( 'wpca-admin' ),\r\n            WPCA_VERSION\r\n        );\r\n        \r\n        // Enqueue main JS\r\n        \wp_enqueue_script(\r\n            'wpca-main',\r\n            WPCA_PLUGIN_URL . 'assets/js/wpca-main.js',\r\n            array( 'jquery' ),\r\n            WPCA_VERSION,\r\n            true\r\n        );\r\n        \r\n        // Enqueue settings JS\r\n        \wp_enqueue_script(\r\n            'wpca-settings',\r\n            WPCA_PLUGIN_URL . 'assets/js/wpca-settings.js',\r\n            array( 'jquery', 'wpca-main' ),\r\n            WPCA_VERSION,\r\n            true\r\n        );\r\n        \r\n        // Localize script\r\n        \wp_localize_script( 'wpca-settings', 'wpca_settings_vars', array(\r\n            'ajax_url' => \admin_url( 'admin-ajax.php' ),\r\n            'nonce' => \wp_create_nonce( 'wpca_settings_nonce' ),\r\n            'save' => \__( 'Save Changes', WPCA_TEXT_DOMAIN ),\r\n            'saved' => \__( 'Settings saved successfully!', WPCA_TEXT_DOMAIN ),\r\n            'error' => \__( 'An error occurred while saving settings.', WPCA_TEXT_DOMAIN )\r\n        ));\r\n    }\r\n}\r\n