<?php\r\n/**\r\n * WPCleanAdmin Core Functions\r\n *\r\n * @package WPCleanAdmin\r\n * @version 1.7.15\r\n * @author Sut\r\n * @author URI: https://github.com/sutchan\r\n * @since 1.7.15\r\n */\r\nif ( ! defined( 'ABSPATH' ) ) {\r\n    exit;\r\n}\r\n\r\n/**\r\n * Get plugin settings\r\n *\r\n * @param string $key Specific setting key to get\r\n * @param mixed $default Default value if setting not found\r\n * @return mixed Plugin settings or specific setting value\r\n */\r\nfunction wpca_get_settings( $key = '', $default = false ) {\r\n    $settings = function_exists( 'get_option' ) ? \get_option( 'wpca_settings', array() ) : array();\r\n    \r\n    if ( empty( $key ) ) {\r\n        return $settings;\r\n    }\r\n    \r\n    return isset( $settings[ $key ] ) ? $settings[ $key ] : $default;\r\n}\r\n\r\n/**\r\n * Update plugin settings\r\n *\r\n * @param array $settings Settings to update\r\n * @return bool Update result\r\n */\r\nfunction wpca_update_settings( $settings ) {\r\n    return function_exists( 'update_option' ) ? \update_option( 'wpca_settings', $settings ) : false;\r\n}\r\n\r\n/**\r\n * Get database settings\r\n *\r\n * @param string $key Specific setting key to get\r\n * @param mixed $default Default value if setting not found\r\n * @return mixed Database settings or specific setting value\r\n */\r\nfunction wpca_get_database_settings( $key = '', $default = false ) {\r\n    $settings = function_exists( 'get_option' ) ? \get_option( 'wpca_database_settings', array() ) : array();\r\n    \r\n    if ( empty( $key ) ) {\r\n        return $settings;\r\n    }\r\n    \r\n    return isset( $settings[ $key ] ) ? $settings[ $key ] : $default;\r\n}\r\n\r\n/**\r\n * Get performance settings\r\n *\r\n * @param string $key Specific setting key to get\r\n * @param mixed $default Default value if setting not found\r\n * @return mixed Performance settings or specific setting value\r\n */\r\nfunction wpca_get_performance_settings( $key = '', $default = false ) {\r\n    $settings = function_exists( 'get_option' ) ? \get_option( 'wpca_performance_settings', array() ) : array();\r\n    \r\n    if ( empty( $key ) ) {\r\n        return $settings;\r\n    }\r\n    \r\n    return isset( $settings[ $key ] ) ? $settings[ $key ] : $default;\r\n}\r\n\r\n/**\r\n * Check if user has access to WPCA features\r\n *\r\n * @return bool True if user has access, false otherwise\r\n */\r\nfunction wpca_current_user_can() {\r\n    return function_exists( 'current_user_can' ) ? \current_user_can( 'manage_options' ) : false;\r\n}\r\n\r\n/**\r\n * Get plugin URL\r\n *\r\n * @param string $path Path relative to plugin directory\r\n * @return string Full plugin URL\r\n */\r\nfunction wpca_get_plugin_url( $path = '' ) {\r\n    return function_exists( 'untrailingslashit' ) ? \untrailingslashit( WPCA_PLUGIN_URL ) . $path : WPCA_PLUGIN_URL . $path;\r\n}\r\n\r\n/**\r\n * Get plugin directory path\r\n *\r\n * @param string $path Path relative to plugin directory\r\n * @return string Full plugin directory path\r\n */\r\nfunction wpca_get_plugin_dir( $path = '' ) {\r\n    return function_exists( 'untrailingslashit' ) ? \untrailingslashit( WPCA_PLUGIN_DIR ) . $path : WPCA_PLUGIN_DIR . $path;\r\n}\r\n\r\n/**\r\n * Get assets URL\r\n *\r\n * @param string $asset_path Asset path relative to assets directory\r\n * @return string Full asset URL\r\n */\r\nfunction wpca_get_asset_url( $asset_path = '' ) {\r\n    return wpca_get_plugin_url( '/assets/' . ltrim( $asset_path, '/' ) );\r\n}\r\n\r\n/**\r\n * Get template path\r\n *\r\n * @param string $template_name Template name\r\n * @return string Full template path\r\n */\r\nfunction wpca_get_template_path( $template_name ) {\r\n    return wpca_get_plugin_dir( '/includes/templates/' . $template_name );\r\n}\r\n\r\n/**\r\n * Load template\r\n *\r\n * @param string $template_name Template name\r\n * @param array $args Arguments to pass to template\r\n */\r\nfunction wpca_load_template( $template_name, $args = array() ) {\r\n    $template_path = wpca_get_template_path( $template_name );\r\n    \r\n    if ( file_exists( $template_path ) ) {\r\n        extract( $args );\r\n        include $template_path;\r\n    }\r\n}\r\n\r\n/**\r\n * Show admin notice\r\n *\r\n * @param string $message Notice message\r\n * @param string $type Notice type (success, error, warning, info)\r\n */\r\nfunction wpca_admin_notice( $message, $type = 'info' ) {\r\n    $allowed_types = array( 'success', 'error', 'warning', 'info' );\r\n    $type = in_array( $type, $allowed_types ) ? $type : 'info';\r\n    \r\n    echo '<div class="notice notice-' . esc_attr( $type ) . ' is-dismissible">';\r\n    echo '<p>' . esc_html( $message ) . '</p>';\r\n    echo '</div>';\r\n}\r\n\r\n/**\r\n * Get plugin version\r\n *\r\n * @return string Plugin version\r\n */\r\nfunction wpca_get_version() {\r\n    return WPCA_VERSION;\r\n}\r\n\r\n/**\r\n * Check if plugin is in debug mode\r\n *\r\n * @return bool True if debug mode is enabled, false otherwise\r\n */\r\nfunction wpca_is_debug() {\r\n    return defined( 'WP_DEBUG' ) && WP_DEBUG;\r\n}\r\n\r\n/**\r\n * Log debug message\r\n *\r\n * @param mixed $message Message to log\r\n * @param string $context Context of the log\r\n */\r\nfunction wpca_log( $message, $context = 'general' ) {\r\n    if ( ! wpca_is_debug() ) {\r\n        return;\r\n    }\r\n    \r\n    $log_message = sprintf( '[WPCleanAdmin] [%s] %s', $context, $message );\r\n    \r\n    if ( is_array( $message ) || is_object( $message ) ) {\r\n        $log_message = sprintf( '[WPCleanAdmin] [%s] %s', $context, print_r( $message, true ) );\r\n    }\r\n    \r\n    error_log( $log_message );\r\n}\r\n\r\n/**\r\n * Sanitize array of data\r\n *\r\n * @param array $data Data to sanitize\r\n * @return array Sanitized data\r\n */\r\nfunction wpca_sanitize_array( $data ) {\r\n    if ( ! is_array( $data ) ) {\r\n        return function_exists( 'sanitize_text_field' ) ? \sanitize_text_field( $data ) : $data;\r\n    }\r\n    \r\n    foreach ( $data as &$value ) {\r\n        if ( is_array( $value ) ) {\r\n            $value = wpca_sanitize_array( $value );\r\n        } else {\r\n            $value = function_exists( 'sanitize_text_field' ) ? \sanitize_text_field( $value ) : $value;\r\n        }\r\n    }\r\n    \r\n    return $data;\r\n}\r\n\r\n/**\r\n * Get current tab from URL\r\n *\r\n * @param string $default Default tab if no tab is specified\r\n * @return string Current tab\r\n */\r\nfunction wpca_get_current_tab( $default = 'dashboard' ) {\r\n    return isset( $_GET['tab'] ) ? ( function_exists( 'sanitize_text_field' ) ? \sanitize_text_field( $_GET['tab'] ) : $_GET['tab'] ) : $default;\r\n}\r\n\r\n/**\r\n * Get settings page URL\r\n *\r\n * @param string $tab Tab to open\r\n * @return string Settings page URL\r\n */\r\nfunction wpca_get_settings_url( $tab = '' ) {\r\n    $url = function_exists( 'admin_url' ) ? \admin_url( 'admin.php?page=wp-clean-admin' ) : '';\r\n    \r\n    if ( ! empty( $tab ) ) {\r\n        $url .= '&tab=' . $tab;\r\n    }\r\n    \r\n    return $url;\r\n}\r\n\r\n/**\r\n * Check if current page is WPCA settings page\r\n *\r\n * @return bool True if current page is WPCA settings page, false otherwise\r\n */\r\nfunction wpca_is_settings_page() {\r\n    return isset( $_GET['page'] ) && $_GET['page'] === 'wp-clean-admin';\r\n}\r\n\r\n/**\r\n * Get plugin menu slug\r\n *\r\n * @return string Plugin menu slug\r\n */\r\nfunction wpca_get_menu_slug() {\r\n    return 'wp-clean-admin';\r\n}\r\n\r\n/**\r\n * Get plugin text domain\r\n *\r\n * @return string Plugin text domain\r\n */\r\nfunction wpca_get_text_domain() {\r\n    return WPCA_TEXT_DOMAIN;\r\n}\r\n\r\n/**\r\n * Check if WordPress version is greater than or equal to specified version\r\n *\r\n * @param string $version Version to check against\r\n * @return bool True if WordPress version is greater than or equal to specified version, false otherwise\r\n */\r\nfunction wpca_is_wp_version_gte( $version ) {\r\n    global $wp_version;\r\n    return version_compare( $wp_version, $version, '>=' );\r\n}\r\n\r\n/**\r\n * Get admin page title\r\n *\r\n * @param string $tab Current tab\r\n * @return string Admin page title\r\n */\r\nfunction wpca_get_admin_page_title( $tab = '' ) {\r\n    $translate = function_exists( '__' ) ? '\__' : function( $text ) { return $text; };\r\n    \r\n    $titles = array(\r\n        'dashboard' => $translate( 'WP Clean Admin Dashboard', WPCA_TEXT_DOMAIN ),\r\n        'settings' => $translate( 'WP Clean Admin Settings', WPCA_TEXT_DOMAIN ),\r\n        'database' => $translate( 'Database Optimization', WPCA_TEXT_DOMAIN ),\r\n        'performance' => $translate( 'Performance Settings', WPCA_TEXT_DOMAIN ),\r\n        'menu' => $translate( 'Menu Management', WPCA_TEXT_DOMAIN ),\r\n        'permissions' => $translate( 'Permissions', WPCA_TEXT_DOMAIN ),\r\n        'login' => $translate( 'Login Customization', WPCA_TEXT_DOMAIN ),\r\n        'cleanup' => $translate( 'Cleanup', WPCA_TEXT_DOMAIN ),\r\n        'resources' => $translate( 'Resource Optimization', WPCA_TEXT_DOMAIN ),\r\n        'reset' => $translate( 'Reset Settings', WPCA_TEXT_DOMAIN )\r\n    );\r\n    \r\n    return isset( $titles[ $tab ] ) ? $titles[ $tab ] : $translate( 'WP Clean Admin', WPCA_TEXT_DOMAIN );\r\n}\r\n