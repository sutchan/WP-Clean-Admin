# 部署指南

## 1. 部署前准备

### 1.1 环境检查

在部署 WP Clean Admin 插件之前，请确保您的环境满足以下要求：

| 检查项 | 要求 | 验证方法 |
|--------|------|----------|
| WordPress 版本 | 5.0+ | 登录 WordPress 后台，查看仪表盘底部版本信息 |
| PHP 版本 | 7.4+ | 安装并激活 "Site Health" 插件，查看 PHP 版本 |
| MySQL 版本 | 5.6+ | 联系您的主机提供商或使用 phpMyAdmin 查看 |
| 磁盘空间 | 至少 10MB 可用空间 | 联系您的主机提供商或使用主机控制面板查看 |
| 文件权限 | 插件目录可写 | 确保 wp-content/plugins/ 目录具有正确的写入权限 |

### 1.2 资源准备

- **插件安装包**：从 GitHub Releases 下载最新版本的 WP Clean Admin 插件 ZIP 文件
- **FTP 客户端**（可选）：如 FileZilla，用于手动上传插件
- **WP-CLI**（可选）：用于命令行部署
- **数据库备份**：部署前建议备份 WordPress 数据库
- **文件备份**：部署前建议备份 WordPress 文件，特别是 wp-content 目录

## 2. 部署方式

WP Clean Admin 插件支持多种部署方式，您可以根据自己的技术水平和环境选择合适的方式。

### 2.1 WordPress 后台自动安装

这是最简单的部署方式，适合大多数用户。

#### 2.1.1 步骤

1. **登录 WordPress 后台**：使用管理员账号登录您的 WordPress 网站后台
2. **导航到插件页面**：在左侧菜单中，点击 "插件" > "安装插件"
3. **搜索插件**：在搜索框中输入 "WP Clean Admin"，然后按回车键
4. **安装插件**：找到 WP Clean Admin 插件，点击 "现在安装" 按钮
5. **激活插件**：安装完成后，点击 "激活" 按钮
6. **配置插件**：激活后，插件会自动跳转到配置页面，或在左侧菜单中点击 "WP Clean Admin" 进行配置

#### 2.1.2 注意事项

- 确保您的服务器可以访问 WordPress.org 插件目录
- 如果搜索不到插件，可能是因为插件尚未发布到 WordPress.org，您需要使用手动安装方式

### 2.2 手动上传安装

如果您无法通过 WordPress 后台自动安装，可以使用手动上传方式。

#### 2.2.1 步骤

1. **下载插件 ZIP 文件**：从 GitHub Releases 下载最新版本的 WP Clean Admin 插件 ZIP 文件
2. **登录 WordPress 后台**：使用管理员账号登录您的 WordPress 网站后台
3. **导航到插件页面**：在左侧菜单中，点击 "插件" > "安装插件"
4. **上传插件**：点击页面顶部的 "上传插件" 按钮
5. **选择文件**：点击 "选择文件" 按钮，选择您下载的 ZIP 文件
6. **安装插件**：点击 "现在安装" 按钮
7. **激活插件**：安装完成后，点击 "激活" 按钮
8. **配置插件**：激活后，插件会自动跳转到配置页面，或在左侧菜单中点击 "WP Clean Admin" 进行配置

#### 2.2.2 注意事项

- 确保 ZIP 文件未损坏，建议重新下载如果安装失败
- 确保 wp-content/plugins/ 目录具有正确的写入权限

### 2.3 FTP 上传安装

如果您无法通过 WordPress 后台上传插件，可以使用 FTP 客户端进行上传。

#### 2.3.1 步骤

1. **下载插件 ZIP 文件**：从 GitHub Releases 下载最新版本的 WP Clean Admin 插件 ZIP 文件
2. **解压 ZIP 文件**：使用解压工具（如 WinRAR、7-Zip）解压 ZIP 文件，得到一个名为 `wp-clean-admin` 的文件夹
3. **连接 FTP 服务器**：使用 FTP 客户端连接到您的 WordPress 服务器
4. **上传插件文件夹**：将解压后的 `wp-clean-admin` 文件夹上传到服务器的 `wp-content/plugins/` 目录
5. **登录 WordPress 后台**：使用管理员账号登录您的 WordPress 网站后台
6. **激活插件**：在左侧菜单中，点击 "插件" > "已安装插件"，找到 WP Clean Admin 插件，点击 "激活" 按钮
7. **配置插件**：激活后，插件会自动跳转到配置页面，或在左侧菜单中点击 "WP Clean Admin" 进行配置

#### 2.3.2 注意事项

- 确保 FTP 连接信息正确（主机名、用户名、密码、端口）
- 上传时保持文件夹结构不变
- 确保上传完成后文件完整，无缺失

### 2.4 WP-CLI 安装

如果您熟悉命令行操作，可以使用 WP-CLI 进行快速部署。

#### 2.4.1 步骤

1. **连接到服务器**：使用 SSH 连接到您的 WordPress 服务器
2. **导航到 WordPress 根目录**：
   ```bash
   cd /path/to/wordpress
   ```
3. **安装插件**：使用 WP-CLI 安装 WP Clean Admin 插件
   ```bash
   # 从 WordPress.org 安装（如果已发布）
   wp plugin install wp-clean-admin --activate
   
   # 或从本地 ZIP 文件安装
   wp plugin install /path/to/wp-clean-admin.zip --activate
   ```
4. **验证安装**：
   ```bash
   wp plugin list | grep wp-clean-admin
   ```
5. **配置插件**：使用 WP-CLI 配置插件（可选）
   ```bash
   wp option update wpca_settings '{"cleanup_menus": true, "remove_dashboard_widgets": true}' --format=json
   ```

#### 2.4.2 注意事项

- 确保服务器已安装 WP-CLI
- 确保您具有足够的权限执行 WP-CLI 命令
- 命令中的路径需要根据您的实际情况进行调整

## 3. 配置步骤

### 3.1 基本配置

1. **访问配置页面**：登录 WordPress 后台，在左侧菜单中点击 "WP Clean Admin"
2. **配置清理选项**：
   - **菜单清理**：选择要隐藏或移除的 WordPress 后台菜单
   - **仪表盘清理**：选择要隐藏或移除的仪表盘小部件
   - **工具栏清理**：选择要隐藏或移除的顶部工具栏项目
   - **编辑器清理**：选择要隐藏或移除的编辑器功能
3. **保存配置**：点击页面底部的 "保存设置" 按钮
4. **刷新页面**：刷新 WordPress 后台页面，查看清理效果

### 3.2 高级配置

1. **访问高级设置**：在 WP Clean Admin 配置页面中，点击 "高级设置" 选项卡
2. **配置高级选项**：
   - **性能优化**：启用或禁用性能优化功能
   - **安全增强**：启用或禁用安全增强功能
   - **自定义 CSS**：添加自定义 CSS 样式
   - **自定义 JavaScript**：添加自定义 JavaScript 代码
3. **保存配置**：点击页面底部的 "保存设置" 按钮

### 3.3 多站点配置

如果您的 WordPress 安装是多站点网络，您可以在网络管理界面中配置 WP Clean Admin 插件：

1. **登录网络管理后台**：使用超级管理员账号登录
2. **导航到插件页面**：在左侧菜单中，点击 "我的站点" > "网络管理" > "插件"
3. **网络激活插件**：找到 WP Clean Admin 插件，点击 "网络激活" 按钮
4. **网络配置**：在左侧菜单中，点击 "设置" > "WP Clean Admin 网络设置"
5. **配置网络选项**：设置适用于整个网络的默认配置
6. **保存配置**：点击页面底部的 "保存网络设置" 按钮

## 4. 部署验证

### 4.1 功能验证

1. **检查菜单清理**：登录 WordPress 后台，检查左侧菜单是否按照配置进行了清理
2. **检查仪表盘清理**：查看仪表盘页面，检查小部件是否按照配置进行了清理
3. **检查工具栏清理**：查看顶部工具栏，检查项目是否按照配置进行了清理
4. **检查编辑器清理**：创建或编辑一篇文章，检查编辑器功能是否按照配置进行了清理

### 4.2 性能验证

1. **使用浏览器开发者工具**：检查后台页面加载时间，确保没有明显的性能下降
2. **使用 Query Monitor 插件**：安装并激活 Query Monitor 插件，检查页面加载的数据库查询数和耗时
3. **使用 GTmetrix 或 WebPageTest**：测试网站前台和后台的加载性能

### 4.3 安全验证

1. **检查权限控制**：使用不同角色的用户登录，验证插件功能是否按照用户角色进行了限制
2. **检查输出转义**：查看页面源代码，确保所有输出都经过了适当的转义
3. **检查安全头部**：使用浏览器开发者工具，检查是否添加了适当的安全 HTTP 头部

## 5. 常见问题与解决方案

### 5.1 插件安装失败

**问题**：上传插件时显示 "无法安装插件。无法复制文件。"

**解决方案**：
- 检查服务器磁盘空间是否充足
- 检查 wp-content/plugins/ 目录的写入权限
- 尝试使用 FTP 上传方式
- 确保 ZIP 文件未损坏，重新下载插件

### 5.2 插件激活后无效果

**问题**：插件激活后，后台菜单和仪表盘没有变化

**解决方案**：
- 确保您已保存了插件配置
- 尝试刷新页面或清除浏览器缓存
- 检查您的用户角色是否有足够的权限
- 检查是否与其他插件冲突，尝试暂时禁用其他插件

### 5.3 插件导致后台无法访问

**问题**：激活插件后，WordPress 后台无法访问，显示错误信息

**解决方案**：
- 使用 FTP 客户端删除 wp-content/plugins/wp-clean-admin/ 目录，强制禁用插件
- 登录 WordPress 后台，检查错误日志
- 更新 WordPress 和 PHP 版本到推荐版本
- 联系插件开发者获取支持

### 5.4 配置不生效

**问题**：保存配置后，设置不生效

**解决方案**：
- 检查是否有缓存插件，尝试清除缓存
- 尝试使用不同的浏览器或隐身模式
- 检查数据库权限，确保 WordPress 可以写入选项表
- 检查 WordPress 调试日志，查看是否有错误信息

## 6. 升级与更新

### 6.1 自动更新

如果 WP Clean Admin 插件已发布到 WordPress.org，您可以通过 WordPress 后台自动更新：

1. **登录 WordPress 后台**：使用管理员账号登录
2. **导航到插件页面**：在左侧菜单中，点击 "插件" > "已安装插件"
3. **检查更新**：如果有可用更新，WP Clean Admin 插件旁边会显示 "更新可用" 链接
4. **更新插件**：点击 "更新可用" 链接，然后点击 "立即更新" 按钮
5. **验证更新**：更新完成后，检查插件功能是否正常

### 6.2 手动更新

如果您需要手动更新插件，可以按照以下步骤进行：

1. **备份当前插件**：使用 FTP 客户端备份 wp-content/plugins/wp-clean-admin/ 目录
2. **下载最新版本**：从 GitHub Releases 下载最新版本的插件 ZIP 文件
3. **解压 ZIP 文件**：解压得到新的 wp-clean-admin 文件夹
4. **上传覆盖**：使用 FTP 客户端将新的 wp-clean-admin 文件夹上传到 wp-content/plugins/ 目录，覆盖原有文件
5. **激活插件**：登录 WordPress 后台，确保插件已激活
6. **验证更新**：检查插件功能是否正常

### 6.3 WP-CLI 更新

使用 WP-CLI 可以快速更新插件：

```bash
# 导航到 WordPress 根目录
cd /path/to/wordpress

# 更新插件
wp plugin update wp-clean-admin

# 验证更新
wp plugin list | grep wp-clean-admin
```

## 7. 回滚与卸载

### 7.1 回滚到之前版本

如果更新后出现问题，您可以回滚到之前的版本：

1. **下载之前版本**：从 GitHub Releases 下载之前工作正常的插件版本
2. **备份当前插件**：备份 wp-content/plugins/wp-clean-admin/ 目录
3. **删除当前插件**：使用 FTP 客户端删除当前的 wp-clean-admin 目录
4. **上传旧版本**：上传之前版本的 wp-clean-admin 目录
5. **激活插件**：确保插件已激活
6. **验证回滚**：检查插件功能是否恢复正常

### 7.2 卸载插件

如果您不再需要 WP Clean Admin 插件，可以按照以下步骤卸载：

1. **登录 WordPress 后台**：使用管理员账号登录
2. **导航到插件页面**：在左侧菜单中，点击 "插件" > "已安装插件"
3. **停用插件**：找到 WP Clean Admin 插件，点击 "停用" 按钮
4. **删除插件**：停用后，点击 "删除" 按钮
5. **确认删除**：在弹出的确认对话框中，点击 "确定" 按钮

**注意**：卸载插件会删除所有插件配置和数据，请谨慎操作。

## 8. 最佳实践

### 8.1 部署前

- **备份数据**：始终在部署前备份 WordPress 数据库和文件
- **测试环境验证**：在测试环境中验证部署流程和配置，然后再部署到生产环境
- **检查兼容性**：确保插件与您的 WordPress 版本、主题和其他插件兼容

### 8.2 部署中

- **选择合适的部署方式**：根据您的技术水平和环境选择合适的部署方式
- **遵循最小权限原则**：使用具有适当权限的用户进行部署，避免使用 root 或管理员账号
- **记录部署过程**：记录部署步骤、配置更改和遇到的问题，便于后续排查和恢复

### 8.3 部署后

- **验证功能**：全面验证插件功能，确保所有配置都能正常工作
- **监控性能**：监控网站性能，确保插件不会导致明显的性能下降
- **检查安全**：检查网站安全，确保插件不会引入安全漏洞
- **文档更新**：更新内部文档，记录部署和配置信息

### 8.4 日常维护

- **定期更新插件**：及时更新插件到最新版本，获取新功能和安全修复
- **定期审查配置**：定期审查插件配置，确保符合当前需求
- **监控日志**：监控 WordPress 错误日志，及时发现和解决问题
- **收集反馈**：收集用户反馈，持续改进插件配置和使用体验

## 9. 总结

本部署指南提供了 WP Clean Admin 插件的全面部署流程，包括部署前准备、多种部署方式、配置步骤、部署验证、常见问题解决方案、升级与更新、回滚与卸载以及最佳实践。

通过遵循本指南，您可以确保 WP Clean Admin 插件的顺利部署和稳定运行，为您的 WordPress 后台提供一个干净、高效的管理环境。

如果您在部署过程中遇到任何问题，请参考常见问题部分，或联系插件开发者获取支持。